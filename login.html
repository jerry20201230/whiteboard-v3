<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>登入</title>
    <link id="browser-icon" rel="shortcut icon" type="image/png" href="/lib/icon-active.png" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />

    <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.1/css/bootstrap.css'
        integrity='sha512-tBwPRcI1t+0jTsIMtf//+V1f0xAWHh7pvPE82A2n5FcBrzl6b0LRE6XnxUTRHti59y4Js7z4Wb/zal2HBsVVOQ=='
        crossorigin='anonymous' />
    <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.9.1/font/bootstrap-icons.css'
        integrity='sha512-CaTMQoJ49k4vw9XO0VpTBpmMz8XpCWP5JhGmBvuBqCOaOHWENWO1CrVl09u4yp8yBVSID6smD4+gpzDJVQOPwQ=='
        crossorigin='anonymous' />


    <style>
        .login-dialog,
        .full-screen-dialog {
            backdrop-filter: blur(10px);
            background: rgba(216, 216, 216, 0.355);
            border-radius: 5px;
            box-shadow: 0px 0px 20px 5px rgb(216 216 216 / 50%);
            position: absolute;
            top: 50%;
            left: 50%;

            max-width: 500px !important;
            min-width: 300px;
            width: 50vw;


            transform: translate(-50%, -50%);
            padding: 15px;

            transition: box-shadow 1s;

        }

        .form-check {
            padding: 0;
        }

        #login-dialog-hide {
            display: none !important;
        }

        #login-dialog-show {
            display: block;
        }

        .center {
            text-align: center !important;
        }

        .select-none {
            user-select: none;
        }

        #bg-img {
            position: fixed;
            top: 50%;
            left: 50%;
            z-index: -99;
        }

        .progress-bar.indeterminate {
            position: relative;
            border-radius: var(--bs-progress-border-radius);

            animation: progress-indeterminate 3s linear infinite;
        }

        @keyframes progress-indeterminate {
            from {
                left: -20%;
                width: 25%;
            }

            to {
                left: 50%;
                width: 35%;
            }

            to {
                left: 100%;
                width: 60%;
            }
        }
    </style>

</head>

<body onload="window.setup()">

    <div id="loading-layer" style="    
    position: fixed;
    top: 0;
    left: 0;
    z-index: 1050;
    width: 100vw;
    height: 100vh;
    background-color:var(--bs-light);
    display: flex;
    align-items: center;
    flex-direction: column;
    justify-content: center;
    text-align: center;">

        <div id="loading-logo"
            style="padding: 15px; user-select: none;display: flex;justify-content: center;align-items: center;border-radius: 5px; border: 1px solid #000; width: 15em; height: 15em; max-width: 50px; max-height: 50px;"
            class="animate__animated animate__fadeInUp">
            <span style="font-size: 35px; " class="animate__animated animate__fadeInUp">
                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"
                    width="40" height="" viewBox="0 0 1080 1080" xml:space="preserve">

                    <g transform="matrix(1 0 0 1 540 540)" id="57004e0c-50fa-4ba1-acd8-62b8c216f992">

                    </g>
                    <g transform="matrix(1 0 0 1 540 540)" id="4173a1b1-6846-463f-8947-2b723efd13a4">
                    </g>
                    <g transform="matrix(5.22 0 0 5.22 823.58 774.41)">
                        <g vector-effect="non-scaling-stroke">
                            <g transform="matrix(1 0 0 1 -14.31 14.48)">
                                <path
                                    style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill: rgb(10,140,44); fill-rule: nonzero; opacity: 1;"
                                    vector-effect="non-scaling-stroke" transform=" translate(-35.69, -64.48)"
                                    d="M 42.531 43.218 L 17.319 68.373 C 13.363999999999999 72.328 13.363999999999999 78.809 17.319 82.76400000000001 C 20.615 86.06000000000002 25.612 86.60900000000001 29.458 84.46700000000001 L 29.458 77.87400000000001 L 34.455 77.87400000000001 L 34.455 68.70200000000001 L 43.903 68.70200000000001 L 43.903 64.47300000000001 L 49.341 64.47300000000001 L 49.341 59.03500000000001 L 55.493 59.03500000000001 L 57.029 57.49900000000001 C 53.73500000000001 56.45400000000001 50.550000000000004 54.58600000000001 47.912000000000006 51.95000000000001 C 45.387 49.424 43.574 46.402 42.531 43.218 z"
                                    stroke-linecap="round" />
                            </g>
                            <g transform="matrix(1 0 0 1 14.93 -15.05)">
                                <path
                                    style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill: rgb(10,140,44); fill-rule: nonzero; opacity: 1;"
                                    vector-effect="non-scaling-stroke" transform=" translate(-64.93, -34.95)"
                                    d="M 79.551 20.313 C 71.475 12.241 58.349000000000004 12.241 50.274 20.313 C 42.202 28.387 42.202 41.516 50.274 49.589 C 58.349000000000004 57.663 71.475 57.663 79.551 49.589 C 87.68 41.515 87.68 28.387 79.551 20.313 z M 75.267 32.671 C 73.068 34.924 69.443 34.924 67.191 32.671 C 64.99600000000001 30.474 64.99600000000001 26.85 67.191 24.599 C 69.443 22.4 73.068 22.4 75.267 24.599 C 77.519 26.85 77.519 30.474 75.267 32.671 z"
                                    stroke-linecap="round" />
                            </g>
                        </g>
                    </g>
                    <g transform="matrix(9.58 0 0 9.58 355.53 453.09)" id="dba3977c-8fba-4392-bc4e-8102117830da">
                        <path
                            style="stroke: rgb(0,0,0); stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill: rgb(67,151,220); fill-rule: nonzero; opacity: 1;"
                            vector-effect="non-scaling-stroke" transform=" translate(-50, -50)"
                            d="M 17.54 46.118 L 23.487 46.118 L 23.487 39.951 C 23.487 38.961 23.487 38.023 23.596999999999998 37.088 L 23.651999999999997 36.923 L 23.651999999999997 36.813 L 23.706999999999997 36.536 L 23.706999999999997 36.206 L 23.761999999999997 35.931000000000004 L 23.816999999999997 35.656000000000006 L 23.816999999999997 35.601000000000006 L 23.871999999999996 35.32600000000001 L 23.871999999999996 35.27100000000001 L 23.926999999999996 35.05100000000001 L 23.926999999999996 34.94100000000001 L 24.093999999999998 34.27900000000001 L 24.093999999999998 34.16900000000001 L 24.147 33.94900000000001 L 24.147 33.89400000000001 L 24.203999999999997 33.674000000000014 L 24.203999999999997 33.619000000000014 L 24.313999999999997 33.344000000000015 L 24.368999999999996 33.01400000000002 L 24.478999999999996 32.73900000000002 L 24.478999999999996 32.682000000000016 L 24.533999999999995 32.46200000000002 L 24.533999999999995 32.40700000000002 L 24.643999999999995 32.18700000000002 L 24.643999999999995 32.07700000000002 L 24.698999999999995 31.91200000000002 L 24.753999999999994 31.74700000000002 L 24.808999999999994 31.63700000000002 L 24.863999999999994 31.472000000000023 L 24.863999999999994 31.362000000000023 L 24.973999999999993 31.142000000000024 L 25.193999999999992 30.535000000000025 L 25.30399999999999 30.260000000000026 L 25.41399999999999 29.985000000000028 L 25.41399999999999 29.930000000000028 L 25.68899999999999 29.325000000000028 L 25.74399999999999 29.21500000000003 L 25.79899999999999 29.05000000000003 C 25.963999999999988 28.77500000000003 26.073999999999987 28.44300000000003 26.24099999999999 28.168000000000028 L 26.35099999999999 27.89300000000003 C 27.61599999999999 25.41600000000003 29.267999999999986 23.15800000000003 31.25099999999999 21.17600000000003 C 34.99599999999999 17.43100000000003 39.89599999999999 14.78900000000003 45.29299999999999 13.85200000000003 L 45.62299999999999 13.79700000000003 L 45.95299999999999 13.742000000000031 L 46.28299999999999 13.687000000000031 L 46.612999999999985 13.632000000000032 L 46.944999999999986 13.577000000000032 L 47.274999999999984 13.522000000000032 L 47.60499999999998 13.522000000000032 L 47.93499999999998 13.467000000000033 L 48.649999999999984 13.467000000000033 L 48.981999999999985 13.412000000000033 L 51.01999999999998 13.412000000000033 L 51.34999999999998 13.467000000000033 L 52.01099999999998 13.467000000000033 L 52.34099999999998 13.522000000000032 L 52.67099999999998 13.522000000000032 L 53.000999999999976 13.577000000000032 L 53.330999999999975 13.632000000000032 L 53.66099999999997 13.687000000000031 L 53.99099999999997 13.742000000000031 L 54.32099999999997 13.79700000000003 L 54.65099999999997 13.85200000000003 C 60.102999999999966 14.78900000000003 64.94799999999996 17.43200000000003 68.69199999999996 21.17600000000003 L 68.74999999999997 21.17600000000003 C 69.95999999999997 22.38600000000003 71.00699999999998 23.70800000000003 71.99699999999997 25.14000000000003 L 71.99699999999997 25.19500000000003 C 72.43699999999997 25.80000000000003 72.87699999999997 26.517000000000028 73.26499999999997 27.177000000000028 L 73.37399999999997 27.452000000000027 L 73.59499999999997 27.892000000000028 L 73.87099999999997 28.38700000000003 L 73.87099999999997 28.44200000000003 L 73.92499999999997 28.49700000000003 L 74.14499999999997 28.994000000000028 L 74.14499999999997 29.049000000000028 L 74.25499999999997 29.214000000000027 L 74.31199999999997 29.324000000000026 C 74.42199999999997 29.654000000000025 74.58499999999997 29.929000000000027 74.69499999999996 30.259000000000025 L 74.80499999999996 30.534000000000024 L 74.91499999999996 30.866000000000025 L 74.97199999999997 31.086000000000023 L 75.02499999999996 31.141000000000023 L 75.08299999999997 31.361000000000022 L 75.24599999999997 31.746000000000024 L 75.24599999999997 31.911000000000023 L 75.41299999999997 32.40600000000002 L 75.46599999999997 32.46100000000002 L 75.52299999999997 32.68100000000002 L 75.52299999999997 32.73800000000002 L 75.63299999999997 33.23300000000002 L 75.74299999999997 33.56300000000002 L 75.74299999999997 33.673000000000016 L 75.79999999999997 33.893000000000015 L 75.85299999999997 34.058000000000014 L 75.91099999999997 34.33300000000001 L 76.01999999999997 34.77500000000001 L 76.01999999999997 34.94000000000001 L 76.07399999999997 35.05000000000001 L 76.13099999999997 35.27000000000001 L 76.13099999999997 35.49000000000001 L 76.24099999999997 35.93000000000001 L 76.24099999999997 36.260000000000005 L 76.29399999999997 36.535000000000004 L 76.29399999999997 36.59 L 76.35099999999997 36.812000000000005 C 76.35099999999997 37.087 76.40499999999997 37.362 76.40499999999997 37.58200000000001 L 76.40499999999997 37.69200000000001 C 76.51399999999997 38.46300000000001 76.51399999999997 39.17900000000001 76.51399999999997 39.95000000000001 L 76.51399999999997 46.11700000000001 L 82.46299999999997 46.11700000000001 L 82.46299999999997 86.58800000000001 L 17.54 86.58800000000001 L 17.54 46.118 z M 34.113 46.118 L 65.832 46.118 L 65.832 39.951 C 65.832 39.18 65.77499999999999 38.409 65.66499999999999 37.638 L 65.612 37.418 L 65.612 37.253 L 65.55399999999999 37.143 L 65.55399999999999 36.978 L 65.50099999999999 36.923 L 65.44399999999999 36.591 L 65.44399999999999 36.426 L 65.38999999999999 36.371 L 65.38999999999999 36.206 L 65.33299999999998 36.096000000000004 L 65.27999999999999 35.876000000000005 L 65.22199999999998 35.656000000000006 L 65.22199999999998 35.601000000000006 L 65.16499999999998 35.43600000000001 L 65.11199999999998 35.32600000000001 L 65.11199999999998 35.21600000000001 L 65.00199999999998 34.88600000000001 L 64.94499999999998 34.71900000000001 L 64.89099999999998 34.71900000000001 L 64.89099999999998 34.55400000000001 L 64.78199999999998 34.33400000000001 L 64.78199999999998 34.27900000000001 L 64.72399999999998 34.22400000000001 L 64.67099999999998 34.05900000000001 L 64.61399999999998 33.94900000000001 L 64.50399999999998 33.72900000000001 L 64.50399999999998 33.619000000000014 L 64.45099999999998 33.564000000000014 L 64.39299999999997 33.454000000000015 L 64.33999999999997 33.289000000000016 L 64.33999999999997 33.234000000000016 C 64.17299999999997 32.95900000000002 64.06299999999997 32.682000000000016 63.89999999999998 32.40700000000002 C 63.67999999999998 32.07700000000002 63.51299999999998 31.747000000000018 63.293999999999976 31.41700000000002 L 63.239999999999974 31.30700000000002 L 63.126999999999974 31.14200000000002 L 63.07299999999997 31.08700000000002 L 63.07299999999997 31.03200000000002 L 62.90599999999997 30.812000000000022 C 62.52299999999997 30.260000000000023 62.13599999999997 29.82000000000002 61.69599999999997 29.325000000000024 C 61.53299999999997 29.105000000000025 61.36599999999997 28.940000000000023 61.14599999999997 28.775000000000023 L 61.14599999999997 28.720000000000024 C 61.03599999999997 28.610000000000024 60.86899999999997 28.498000000000022 60.75899999999997 28.333000000000023 L 60.64899999999997 28.223000000000024 L 60.595999999999975 28.223000000000024 L 60.485999999999976 28.113000000000024 C 58.88799999999998 26.683000000000025 56.961999999999975 25.581000000000024 54.866999999999976 24.865000000000023 L 54.70399999999998 24.810000000000024 L 54.48399999999998 24.755000000000024 L 54.31699999999998 24.700000000000024 L 54.09599999999998 24.645000000000024 L 53.932999999999986 24.590000000000025 L 53.71299999999999 24.590000000000025 L 53.545999999999985 24.535000000000025 L 53.38299999999999 24.480000000000025 L 53.16299999999999 24.423000000000027 L 52.99599999999999 24.368000000000027 L 52.78 24.368000000000027 L 52.614000000000004 24.313000000000027 L 52.39300000000001 24.313000000000027 L 52.17300000000001 24.258000000000028 L 52.01000000000001 24.258000000000028 L 51.789000000000016 24.203000000000028 L 51.62400000000002 24.203000000000028 L 51.40300000000002 24.148000000000028 L 50.57600000000002 24.148000000000028 L 50.41100000000002 24.09300000000003 L 49.58600000000002 24.09300000000003 L 49.36600000000002 24.148000000000028 L 48.59400000000002 24.148000000000028 L 48.374000000000024 24.203000000000028 L 48.154000000000025 24.203000000000028 L 47.989000000000026 24.258000000000028 L 47.76900000000003 24.258000000000028 L 47.60400000000003 24.313000000000027 L 47.38400000000003 24.313000000000027 L 47.16400000000003 24.368000000000027 L 47 24.368000000000027 L 46.778 24.423000000000027 L 46.613 24.480000000000025 L 46.448 24.535000000000025 L 46.228 24.590000000000025 L 46.063 24.590000000000025 L 45.843 24.645000000000024 L 45.678000000000004 24.700000000000024 L 45.458000000000006 24.755000000000024 L 45.293000000000006 24.810000000000024 L 45.12800000000001 24.865000000000023 L 44.90800000000001 24.920000000000023 L 44.74100000000001 25.030000000000022 L 44.57600000000001 25.085000000000022 C 42.92600000000001 25.690000000000023 41.43800000000001 26.51700000000002 40.06100000000001 27.617000000000022 L 39.95100000000001 27.72700000000002 L 39.78600000000001 27.83700000000002 L 39.62100000000001 27.94700000000002 L 39.62100000000001 28.00200000000002 L 39.51100000000001 28.11200000000002 L 39.34600000000001 28.22200000000002 L 39.23600000000001 28.33200000000002 L 38.796000000000014 28.71900000000002 L 38.796000000000014 28.77400000000002 C 38.189000000000014 29.37900000000002 37.58400000000001 30.09400000000002 37.088000000000015 30.81200000000002 L 36.868000000000016 31.087000000000018 L 36.81300000000002 31.197000000000017 L 36.75800000000002 31.252000000000017 L 36.70300000000002 31.307000000000016 L 36.64800000000002 31.417000000000016 L 36.371000000000016 31.912000000000017 L 36.31600000000002 32.02200000000002 L 36.26100000000002 32.07700000000002 L 36.20600000000002 32.13200000000002 L 36.15100000000002 32.24200000000002 L 36.15100000000002 32.29700000000002 L 36.09600000000002 32.40700000000002 L 35.98600000000002 32.57200000000002 L 35.71100000000002 33.12400000000002 L 35.54600000000002 33.509000000000015 L 35.49100000000002 33.564000000000014 L 35.49100000000002 33.619000000000014 L 35.43600000000002 33.674000000000014 L 35.32600000000002 33.94900000000001 L 35.32600000000002 34.00400000000001 L 35.21600000000002 34.27900000000001 L 35.21600000000002 34.33400000000001 L 35.16100000000002 34.44400000000001 L 35.10600000000002 34.49900000000001 L 35.10600000000002 34.55400000000001 L 35.05100000000002 34.71900000000001 L 34.99600000000002 34.88600000000001 L 34.941000000000024 35.05100000000001 L 34.886000000000024 35.16100000000001 L 34.886000000000024 35.27100000000001 L 34.831000000000024 35.32600000000001 L 34.831000000000024 35.43600000000001 L 34.776000000000025 35.49100000000001 L 34.776000000000025 35.656000000000006 L 34.721000000000025 35.821000000000005 L 34.666000000000025 35.986000000000004 L 34.611000000000026 36.096000000000004 L 34.501000000000026 36.591 L 34.501000000000026 36.756 L 34.444000000000024 36.923 L 34.444000000000024 36.978 C 34.39100000000003 37.198 34.334000000000024 37.473 34.334000000000024 37.693000000000005 C 34.224000000000025 38.464000000000006 34.169000000000025 39.18000000000001 34.169000000000025 39.95100000000001 L 34.114000000000026 39.95100000000001 L 34.114000000000026 46.118 z M 47.385 64.618 L 47.22 66.216 L 47.165 67.37299999999999 C 46.945 70.07 46.668 73.20799999999998 46.338 77.00999999999999 L 53.661 77.00999999999999 C 53.331 73.20799999999998 53.057 70.071 52.834 67.37299999999999 L 52.724000000000004 66.216 L 52.615 64.618 L 52.615 64.565 C 54.049 63.626999999999995 54.986000000000004 62.086999999999996 54.986000000000004 60.269999999999996 C 54.986000000000004 57.51499999999999 52.781000000000006 55.257999999999996 50.083000000000006 55.202 L 49.918000000000006 55.202 C 47.165000000000006 55.259 44.96300000000001 57.515 44.96300000000001 60.269999999999996 C 44.96300000000001 62.086999999999996 45.95300000000001 63.626999999999995 47.385000000000005 64.565 L 47.385000000000005 64.618 z"
                            stroke-linecap="round" />
                    </g>
                </svg>
            </span>
        </div>

        <p></p>
        <h3 id="loading-status">資料讀取中</h3>
        <p></p>
        <div class="progress animate__animated animate__fadeInUp"
            style="max-width: 250px; position: relative;width: 25%;height: 1%;">
            <div class="progress-bar progress-bar-striped indeterminate">
            </div>

        </div>
        <div id="loading-failed-text-container"></div>

    </div>



    <div id="background"></div>
    <div id="login-dialog" class="login-dialog">
        <h1>登入</h1>
        <p>登入以使用所有功能<br>
            如果沒有帳號，請先註冊</p>
        <p>
        <div class="form-check mb-3">
            <label for="user_account">使用者帳號:</label>

            <div class="input-group mb-3">
                <span class="input-group-text">@</span><input type="text" class="form-control" placeholder="使用者帳號"
                    id="user_account">
            </div>

            <div class="invalid-feedback" id="login_user_account_alert" style="display: none;"></div>
        </div>
        <div class="form-check mb-3">
            <label for="user_password">使用者密碼:</label><input type="password" class="form-control" placeholder="使用者密碼"
                id="user_password">
            <span class="badge bg-danger" id="login_user_password_alert" style="display: none;"></span>

        </div>
        <div class="alert alert-danger" id="login_error_alert" style="display: none;"></div>
        <p class="d-flex">

            <button class="btn btn-primary" id="login_btn" type="submit">登入</button>
            <span class="select-none">&nbsp;</span>
            <button class="btn btn-secondary toggle-btn">註冊</button>
            <span class="select-none">&nbsp;</span>
            <button class="btn btn-light skip_login_btn">訪客登入</button>

        </p>
    </div>

    <div id="sign-up-dialog" class="login-dialog" style="display: none;">
        <h1>註冊</h1>
        <p>註冊新帳號<br>
            如果已經有帳號，請登入</p>
        <p>

        <div class="form-check mb-3">
            <label for="signup_user_nickname">你的暱稱:</label><input type="text    " class="form-control" placeholder="暱稱"
                id="signup_user_nickname">
            <div class="invalid-feedback" id="signup_user_nickname_alert" style="display: none;"></div>

        </div>
        <div class="form-check mb-3">
            <label for="sign_up_user_account">你的使用者帳號:</label>

            <div class="input-group mb-3">
                <span class="input-group-text">@</span><input type="text" class="form-control" placeholder="使用者帳號"
                    id="sign_up_user_account">
            </div>

            <div class="invalid-feedback" id="signup_user_account_alert" style="display: none;"></div>
        </div>
        <div class="form-check mb-3">
            <label for="sign_up_user_password">密碼:</label><input type="password" class="form-control"
                placeholder="使用者密碼" id="sign_up_user_password">
            <div class="invalid-feedback" id="signup_user_password_alert" style="display: none;"></div>

        </div>
        <div class="form-check mb-3">
            <label for="sign_up_user_password_2">確認密碼:</label><input type="password" class="form-control"
                placeholder="確認密碼" id="sign_up_user_password_2">
            <div class="invalid-feedback" id="signup_user_password_2_alert" style="display: none;"></div>

        </div>
        <div class="alert alert-danger" id="signup_error_alert" style="display: none;"></div>
        <p class="d-flex">

            <button class="btn btn-primary" id="signup_btn">註冊</button>
            <span class="select-none">&nbsp;</span>
            <button class="btn btn-secondary toggle-btn">登入</button>
            <span class="select-none">&nbsp;</span>
            <button class="btn btn-light skip_login_btn">訪客登入</button>
        </p>

    </div>
    <div onclick="imginfo()" style="
    box-shadow: 0px 0px 20px 5px rgba(255, 255, 255, 0.21);
    backdrop-filter: blur(10px);border-radius: 5px;
    background: rgba(216, 216, 216, 0.15);position: fixed; bottom:0;width: fit-content;padding: 5px; cursor: pointer;">
        <span class="text-light text-opacity-50">
            <i class="bi bi-info-circle"></i>
        </span>
    </div>


    <div class="modal fade " id="Modal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
        aria-labelledby="ModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable ">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="ModalLabel"></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"
                        id="modal-close-btn"></button>
                </div>
                <div class="modal-body">

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" id="modal-esc-button">
                        取消
                    </button>
                    <button type="button" class="btn btn-warning" data-bs-dismiss="modal" id="modal-enter-button">
                        確定
                    </button>

                </div>
            </div>
        </div>
    </div>
    <div id="toast" class="position-fixed bottom-0 end-0 p-3 toast-container"></div>

    <!--<script src="/socket.io/socket.io.js"></script>
    -->
    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.js'
        integrity='sha512-CX7sDOp7UTAq+i1FYIlf9Uo27x4os+kGeoT7rgwvY+4dmjqV0IuE/Bl5hVsjnQPQiTOhAX1O2r2j5bjsFBvv/A=='
        crossorigin='anonymous'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.1/js/bootstrap.js'
        integrity='sha512-sVtqu//5Nt9ezFxWXCLcYjITUpvE2uin3m6zeClCHkHfWOshi732EGhrim4qL7kawS5ipwU/rmQo7ZirKzDvfQ=='
        crossorigin='anonymous'></script>

    <script>
        var status = "login";
        function delay(time) {
            return new Promise(resolve => setTimeout(resolve, time));
        }
        //{title,body,escCallBack,enterCallBack}
        function PopupAlert(par) {
            console.log(par)
            let _Modal = new bootstrap.Modal(document.getElementById('Modal'));
            $('.modal-title').html('');
            $('.modal-body').html('');
            $('#modal-esc-btn').removeAttr('onclick');
            $('#modal-enter-btn').removeAttr('onclick');
            $('#modal-esc-btn').removeAttr('disabled');
            $('#modal-enter-btn').removeAttr('disabled');
            $('#modal-enter-btn').show();
            $('#modal-esc-btn').show();
            $(".modal-backdrop").remove();
            $("#modal-close-btn").show();

            //------------------------------------------------//

            $('.modal-title').html(par.title);
            $('.modal-body').html(par.body);

            if (par.escCallBack == 'dismiss') { $('#modal-esc-btn').show(); }
            else if (par.escCallBack == 'x') { $('#modal-esc-button').hide(); }
            else { $('#modal-esc-button').attr('onclick', par.escCallBack); }

            if (par.enterCallBack == 'dismiss') { $('#modal-enter-btn').show(); }
            else if (par.enterCallBack == 'x') { $('#modal-enter-button').hide(); }
            else { $('#modal-enter-button').attr('onclick', par.enterCallBack); }



            if (par.closeButtonStatue == undefined || par.closeButtonStatue == true) {
                $("#modal-close-btn").show()

            } else {

                $("#modal-close-btn").hide()
            }


            _Modal.toggle();


        }
        window.mobileAndTabletCheck = function () {
            let check = false;
            (function (a) { if (/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0, 4))) check = true; })(navigator.userAgent || navigator.vendor || window.opera);
            return check;
        };

        window.setup = function () {
            choose_img()

            if (window.mobileAndTabletCheck()) {
                resize_tab()
            }
            if ($.UrlParam("signuped") == "true") {
                BS_Toast.show({
                    icon: 'bi-person-fill',
                    iconClass: '',
                    title: '註冊成功',
                    body: `請使用你的帳號登入`,
                    toastClass: "text-bg-success"
                })
            }
        }


        $("#user_account").on("blur", function (e) {
            if ($("#user_account").val() == "") {
                $("#login_user_account_alert").html("*請填寫此欄位*").show();
                $("#user_account").addClass("is-invalid")
            }
        })

        window.onkeydown = function (e) {
            if (e.keyCode == 13 & status == "login") {
                if ($("#user_account").val() == "") {
                    $("#login_user_account_alert").html("*請填寫此欄位*").show();
                    $("#user_account").addClass("is-invalid")
                } else {

                    $("#login_btn").attr("disabled", true).html("正在登入 " + `<div class="spinner-border  spinner-border-sm" role="status"><span class="visually-hidden">Loading...</span></div>`)

                    $(".skip_login_btn").attr("disabled", true)
                    $("#user_account").attr("disabled", true)
                    $("#user_password").attr("disabled", true);
                    $(".toggle-btn").attr("disabled", true)

                    status = "logining"
                    $("#login_error_alert").text("").hide()

                    fetch('/account/login', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            user: {
                                account: $("#user_account").val(),
                                pass: $("#user_password").val()
                            }
                        })
                    })
                        .then(res => res.json())

                        .then((json) => {
                            if (json.code === "failed") {
                                $("#login_error_alert").text(json.par.text).show();


                                $("#user_account").removeAttr("disabled")
                                $("#user_password").removeAttr("disabled")
                                $(".toggle-btn").removeAttr("disabled")
                                $(".skip_login_btn").removeAttr("disabled")
                                $("#login_btn").removeAttr("disabled").html("登入")
                                status = "login"

                            } else {
                                if (!$.UrlParam("next")) {
                                    location.href = "/"
                                } else {
                                    location.href = "/file" + $.UrlParam("next")
                                }
                            }
                        })

                        .catch(error => {
                            console.log(error)
                            $("#login_error_alert").text("發生錯誤，暫時無法將你登入").show();
                            $("#user_account").removeAttr("disabled")
                            $("#user_password").removeAttr("disabled")
                            $(".skip_login_btn").removeAttr("disabled")
                            $(".toggle-btn").removeAttr("disabled")
                            $("#login_btn").removeAttr("disabled").html("登入")
                            status = "login"
                        })
                }
            }
        }

        $("#login_btn").on("click", function (e) {
            if ($("#user_account").val() == "") {
                $("#login_user_account_alert").html("*請填寫此欄位*").show();
                $("#user_account").addClass("is-invalid")
            } else {

                $("#login_btn").attr("disabled", true).html("正在登入 " + `<div class="spinner-border  spinner-border-sm" role="status"><span class="visually-hidden">Loading...</span></div>`)

                $(".skip_login_btn").attr("disabled", true)
                $("#user_account").attr("disabled", true)
                $("#user_password").attr("disabled", true);
                $(".toggle-btn").attr("disabled", true)

                status = "logining"
                $("#login_error_alert").text("").hide()

                fetch('/account/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        user: {
                            account: $("#user_account").val(),
                            pass: $("#user_password").val()
                        }
                    })
                })
                    .then(res => res.json())

                    .then((json) => {
                        if (json.code === "failed") {
                            $("#login_error_alert").text(json.par.text).show();


                            $("#user_account").removeAttr("disabled")
                            $("#user_password").removeAttr("disabled")
                            $(".toggle-btn").removeAttr("disabled")
                            $(".skip_login_btn").removeAttr("disabled")
                            $("#login_btn").removeAttr("disabled").html("登入")
                            status = "login"

                        } else {
                            if (!$.UrlParam("next")) {
                                location.href = "/"
                            } else {
                                location.href = "/file" + $.UrlParam("next")
                            }

                        }
                    })

                    .catch(error => {
                        console.log(error)
                        $("#login_error_alert").text("發生錯誤，暫時無法將你登入").show();
                        $("#user_account").removeAttr("disabled")
                        $("#user_password").removeAttr("disabled")
                        $(".skip_login_btn").removeAttr("disabled")
                        $(".toggle-btn").removeAttr("disabled")
                        $("#login_btn").removeAttr("disabled").html("登入")
                        status = "login"
                    })
            }
        })
        $("#user_account").on("focus", function (e) {
            $("#login_user_account_alert").hide()
            $("#user_account").removeClass("is-invalid")
            $("#login_error_alert").text("").hide()
        })
        $("body").on("keydown", function (event) {
            if (event.which == 13 && status == "login") {
                if ($("#user_account").val() == "") {
                    $("#login_user_account_alert").html("*請填寫此欄位*").show();
                    $("#user_account").addClass("is-invalid")
                } else if (event.which == 13 && status == "signup") {
                    if ($("#sign_up_user_password").val() !== $("#sign_up_user_password_2").val()) {
                        $("#signup_error_alert").text("兩次輸入的密碼不同，請重新輸入").show()
                    }
                    else if (IfStrIsBlank($("#sign_up_user_password").val()) || $("#sign_up_user_password").val().split("").length > 30 || $("#sign_up_user_password").val().split("").length < 6) {
                        $("#signup_error_alert").text("密碼需在6到30字之間，建議包含特殊符號以提升安全性").show()
                    }
                    else {
                        $("#sign_up_user_account").attr("disabled", true)
                        $("#sign_up_user_password").attr("disabled", true)
                        $("#sign_up_user_password_2").attr("disabled", true)
                        $("#signup_user_nickname").attr("disabled", true)
                        $(".skip_login_btn").attr("disabled", true)
                        $("#signup_btn").attr("disabled", true).html("正在註冊 " + `<div class="spinner-border spinner-border-sm" role="status"><span class="visually-hidden">Loading...</span></div>`)

                        fetch("/account/signup", {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({
                                action: "signup",
                                uid: $("#sign_up_user_account").val(),
                                pass: $("#sign_up_user_password").val(),
                                nickname: $("#signup_user_nickname").val()
                            })
                        })
                            .then(res => res.json())
                            .then(data => {
                                console.log(data)
                                if (data.code === "failed") {
                                    $("#signup_error_alert").text(data.par.text).show();
                                    $("#sign_up_user_account").removeAttr("disabled")
                                    $("#sign_up_user_password").removeAttr("disabled")
                                    $("#sign_up_user_password_2").removeAttr("disabled")
                                    $("#signup_user_nickname").removeAttr("disabled")
                                    $(".skip_login_btn").removeAttr("disabled")
                                    $("#signup_btn").removeAttr("disabled").html("註冊")

                                } else {
                                    $("#signup_error_alert").removeClass("alert-danger").addClass("alert-success").text(data.par.text).show()
                                    $(".skip_login_btn").removeAttr("disabled")
                                    $("#signup_btn").html("註冊")
                                    $("#sign_up_user_account").val("")
                                    $("#sign_up_user_password").val("")
                                    $("#sign_up_user_password_2").val("")
                                    $("#signup_user_nickname").val("")


                                }
                            })
                            .catch(error => {
                                console.log(error)
                                $("#signup_error_alert").text("發生錯誤，暫時無法註冊你的帳號").show()
                                $("#sign_up_user_account").removeAttr("disabled")
                                $("#sign_up_user_password").removeAttr("disabled")
                                $("#sign_up_user_password_2").removeAttr("disabled")
                                $("#signup_user_nickname").removeAttr("disabled")
                                $(".skip_login_btn").removeAttr("disabled")
                                $("#signup_btn").removeAttr("disabled").html("註冊")

                            })
                    }
                }
            }

        });


        $(".skip_login_btn").on("click", function (e) {
            PopupAlert({
                title: "確定繼續?",
                body: "你將使用訪客身分登入，部分功能將受到限制",
                escCallBack: "dismiss",
                enterCallBack: "guestlogin()"
            })
        })

        function guestlogin(e) {
            $("#login_btn").attr("disabled", true).html("正在登入 " + `<div class="spinner-border  spinner-border-sm" role="status"><span class="visually-hidden">Loading...</span></div>`)

            $(".skip_login_btn").attr("disabled", true)
            $("#user_account").attr("disabled", true)
            $("#user_password").attr("disabled", true);
            $(".toggle-btn").attr("disabled", true)
            fetch('/account/login', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    user: {
                        account: "guest",
                        pass: "password"
                    }
                })
            })
                .then(res => res.json())

                .then((json) => {
                    if (json.code === "failed") {
                        $("#login_error_alert").text(json.par.text).show();


                        $("#user_account").removeAttr("disabled")
                        $("#user_password").removeAttr("disabled");
                        $("#login_btn").removeAttr("disabled").html("登入")

                    } else {
                        if (!$.UrlParam("next")) {
                            location.href = "/"
                        } else {
                            location.href = "/file" + $.UrlParam("next")
                        }
                    }
                });
        }
        $("#signup_btn").on("click", function (e) {
            if ($("#sign_up_user_password").val() !== $("#sign_up_user_password_2").val()) {
                $("#signup_error_alert").text("兩次輸入的密碼不同，請重新輸入").show()
            }
            else if (IfStrIsBlank($("#sign_up_user_password").val()) || $("#sign_up_user_password").val().split("").length > 30 || $("#sign_up_user_password").val().split("").length < 6) {
                $("#signup_error_alert").text("密碼需在6到30字之間，建議包含特殊符號以提升安全性").show()
            }
            else {
                $("#sign_up_user_account").attr("disabled", true)
                $("#sign_up_user_password").attr("disabled", true)
                $("#sign_up_user_password_2").attr("disabled", true)
                $("#signup_user_nickname").attr("disabled", true)
                $(".skip_login_btn").attr("disabled", true)
                $("#signup_btn").attr("disabled", true).html("正在註冊 " + `<div class="spinner-border spinner-border-sm" role="status"><span class="visually-hidden">Loading...</span></div>`)

                fetch("/account/signup", {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        action: "signup",
                        uid: $("#sign_up_user_account").val(),
                        pass: $("#sign_up_user_password").val(),
                        nickname: $("#signup_user_nickname").val()
                    })
                })
                    .then(res => res.json())
                    .then(data => {
                        console.log(data)
                        if (data.code === "failed") {
                            $("#signup_error_alert").text(data.par.text).show();
                            $("#sign_up_user_account").removeAttr("disabled")
                            $("#sign_up_user_password").removeAttr("disabled")
                            $("#sign_up_user_password_2").removeAttr("disabled")
                            $("#signup_user_nickname").removeAttr("disabled")
                            $(".skip_login_btn").removeAttr("disabled")
                            $("#signup_btn").removeAttr("disabled").html("註冊")

                        } else {
                            $("#signup_error_alert").removeClass("alert-danger").addClass("alert-success").text(data.par.text).show()
                            $(".skip_login_btn").removeAttr("disabled")
                            $("#signup_btn").html("註冊")
                            $("#sign_up_user_account").val("")
                            $("#sign_up_user_password").val("")
                            $("#sign_up_user_password_2").val("")
                            $("#signup_user_nickname").val("")


                        }
                    })
                    .catch(error => {
                        console.log(error)
                        $("#signup_error_alert").text("發生錯誤，暫時無法註冊你的帳號").show()
                        $("#sign_up_user_account").removeAttr("disabled")
                        $("#sign_up_user_password").removeAttr("disabled")
                        $("#sign_up_user_password_2").removeAttr("disabled")
                        $("#signup_user_nickname").removeAttr("disabled")
                        $(".skip_login_btn").removeAttr("disabled")
                        $("#signup_btn").removeAttr("disabled").html("註冊")

                    })
            }
        })
        $("#signup_user_nickname").on("input", function (e) {
            $("#signup_error_alert").hide()
        })
        $("#sign_up_user_account").on("input", function (e) {
            $("#signup_error_alert").hide()
        })
        $("#sign_up_user_password").on("input", function (e) {
            $("#signup_error_alert").hide()
        })
        $("#sign_up_user_password_2").on("input", function (e) {
            $("#signup_error_alert").hide()
        })
        $(".toggle-btn").on("click", function (e) {
            if (status == "login") {
                status = "signup"
                $("#login-dialog").hide()
                $("#sign-up-dialog").show()
                fetch("/account/signup/getid", {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                }).then(res => res.json())
                    .then(data => $("#sign_up_user_account").val(data.par.uid))
            } else if (status == "signup") {
                status = "login"
                $("#sign-up-dialog").hide()
                $("#login-dialog").show()
            }
            console.log(status)
        })



        function IfStrIsBlank(str) {
            let _arr = str.split(" "),
                _s;
            for (i = 0; i < _arr.length; i++) {

                if (_arr[i] !== " " && _arr[i] !== "") {


                    return false
                }
            }

            return true
        }
        (function ($) {
            $.UrlParam = function (name) {
                //宣告正規表達式
                var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
                /*
                 * window.location.search 獲取URL ?之後的參數(包含問號)
                 * substr(1) 獲取第一個字以後的字串(就是去除掉?號)
                 * match(reg) 用正規表達式檢查是否符合要查詢的參數
                */
                var r = window.location.search.substr(1).match(reg);
                //如果取出的參數存在則取出參數的值否則回穿null
                if (r != null) return (r[2]); return null;
            }
        })(jQuery);

        //date -> formated str (y/m/d)
        //time -> formated str (h:m:s)
        //pack -> {year,month,date,day,hour,minute,second}
        function getTime(type) {
            var DATE = new Date(),
                year = DATE.getFullYear(),
                mont = DATE.getMonth() + 1,
                date = DATE.getDate(),
                day = DATE.getDay(),
                //--------------------//
                hour = DATE.getHours(),
                mins = DATE.getMinutes(),
                secs = DATE.getSeconds();

            if (type == "date") {
                return `${year} / ${mont} / ${date}`
            } else
                if (type == "time") {
                    return `${hour} : ${mins} : ${secs}`
                } else
                    if (type == "pack") {
                        let par = {
                            "year": year,
                            "month": mont,
                            "date": date,
                            "day": day,
                            "hour": hour > 10 ? hour : '0' + hour,
                            "minute": mins > 10 ? mins : '0' + mins,
                            "second": secs > 10 ? secs : '0' + secs
                        }

                        return par
                    }
        }
        //{ icon,         iconClass,     title,  body  toastClass}
        //  ^ex:bi-text  ^ex:text-success              ^ex:text-bg-primary
        var BS_Toast = {
            toast_id: 0,

            show: function (data) {
                let hour = getTime("pack").hour,
                    mins = getTime("pack").minute;
                $("#toast").append(` 
            <div id='BS-Toast-${BS_Toast.toast_id}' class="toast ${data.toastClass}" role="alert" aria-live="assertive" aria-atomic="true">
              <div class="toast-header" >
                <i class='bi ${data.icon} ${data.iconClass}'></i>&nbsp;
                <strong class="me-auto">${data.title}</strong>
                <small>${hour}:${mins}</small>
                <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
             </div>
            <div class="toast-body">${data.body}</div>
            </div>`)

                var toastElList = document.querySelectorAll('.toast')
                var toastList = [...toastElList].map(toastEl => new bootstrap.Toast(toastEl))
                let Thistoast = new bootstrap.Toast(document.getElementById(`BS-Toast-${BS_Toast.toast_id}`))

                Thistoast.show()

                BS_Toast.toast_id++
            }
        }




        function getRandomInt(min, max) {
            min = Math.ceil(min);
            max = Math.floor(max);
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }
        var describe = ["日出", "湖泊", "星空", "星空", "山峰", "森林", "星系", "極光", "湖泊", "瀑布"]
        var whiteText = [false, true, true, true, false, false, true, false, false, false]
        var currentImg;
        function choose_img(params) {


            if (!$.UrlParam("image")) {
                var index = getRandomInt(1, 10)
                $("#background").html(`<img src="/lib/background/background-${index}.png" id="bg-img" draggable="false" class="select-none" alt="無法顯示背景圖片" onload="resize_tab();delay(1000).then(() => $('#loading-layer').remove());
                    " onerror=" $('#loading-status').attr('class', 'text-danger').text('發生暫時性的錯誤，請刷新頁面')">`)

                if (whiteText[index - 1] === true) {
                    $(".login-dialog").css("color", "var(--bs-light)").addClass("text-opacity-75")
                }
                $("#bg-text").text(describe[index - 1])
                resize_tab()
                resize_tab()
                if (window.innerWidth < 720) {
                    resize_tab()
                }
                currentImg = index
            } else {

                if (0 < Number($.UrlParam("image")) && Number($.UrlParam("image")) < 11) {

                    var index = Number($.UrlParam("image"))
                    $("#background").html(`<img src="/lib/background/background-${index}.png" id="bg-img" draggable="false" class="select-none" alt="無法顯示背景圖片" onload="resize_tab(); delay(1000).then(() => $('#loading-layer').remove())" onerror=" $('#loading-status').attr('class', 'text-danger').text('發生暫時性的錯誤，請刷新頁面')">`)
                    if (whiteText[index - 1] === true) {
                        $(".login-dialog").css("color", "var(--bs-light)").addClass("text-opacity-75")
                    }
                    $("#bg-text").text(describe[index - 1])
                    resize_tab()
                    resize_tab()
                    if (window.innerWidth < 720) {
                        resize_tab()
                    }
                    currentImg = index
                } else {
                    var index = getRandomInt(1, 10)
                    $("#background").html(`<img src="/lib/background/background-${index}.png" id="bg-img" draggable="false" class="select-none" alt="無法顯示背景圖片" onload="resize_tab(); delay(1000).then(() => $('#loading-layer').remove())" onerror=" $('#loading-status').attr('class', 'text-danger').text('發生暫時性的錯誤，請刷新頁面')">`)
                    if (whiteText[index - 1] === true) {
                        $(".login-dialog").css("color", "var(--bs-light)").addClass("text-opacity-75")
                    }
                    $("#bg-text").text(describe[index - 1])
                    resize_tab()
                    resize_tab()
                    if (window.innerWidth < 720) {
                        resize_tab()
                    }
                    currentImg = index
                }
            }


        }

        function changeImg(params) {


            var index = currentImg++
            if (currentImg + 1 > 11) {
                var index = getRandomInt(1, 10)
            } else {
                var index = currentImg++
            }
            $("#background").html(`<img src="/lib/background/background-${index}.png" id="bg-img" style="display:none" draggable="false" class="select-none" alt="無法顯示背景圖片" onload="resize_tab();$(this).show()" onerror=" $('#loading-status').attr('class', 'text-danger').text('發生暫時性的錯誤，請刷新頁面')">`)
            if (whiteText[index - 1] === true) {
                $(".login-dialog").css("color", "var(--bs-light)").addClass("text-opacity-75")
            } else {
                $(".login-dialog").css("color", "#000").removeClass("text-opacity-75")
            }
            $("#bg-text").text(describe[index - 1])
            resize_tab()
            resize_tab()
            if (window.innerWidth < 720) {
                resize_tab()
            }
            currentImg = index

        }

        /*$(window).resize(function () {
            resize_tab();
        }).resize();*/
        window.onresize = function (e) {
            resize_tab();
            resize_tab()

        }
        function resize_tab() {

            var viewportWidth = $(window).innerWidth();
            var viewportHeight = $(window).innerHeight();

            var width = $('#bg-img').width();
            var height = $('#bg-img').height();


            if ((viewportWidth / viewportHeight) > (width / height)) {

                $('#bg-img').css({
                    'width': '100%',
                    'height': 'auto',
                    'margin-left': 0 - width / 2,
                    'margin-top': 0 - height / 2
                });


            } else {
                $('#bg-img').css({
                    'width': 'auto',
                    'height': '100%',
                    'margin-left': 0 - width / 2,
                    'margin-top': 0 - height / 2
                });
            }
        }
        function imginfo(params) {
            PopupAlert({
                title: "關於背景圖片",
                body: `
                <h3>${describe[currentImg - 1]}</h3>
                <h6>背景#${currentImg}</h6>
                <hr>
                由<a href="https://openai.com/dall-e-2/" target="_blank">DALL·E 2</a>生成</span><br>
                <a href="https://whiteboard.up.railway.app/lib/background/background-${currentImg}.png" target="_blank">查看完整圖片</a>
                <!--<button class="btn btn-sm btn-primary" data-bs-dismiss="modal" onclick="changeImg()">換一張背景圖片</button>-->`,
                escCallBack: "x",
                enterCallBack: "dismiss"
            })
        }


        window.onerror = function () {
            $(".progress").remove()
            $("#loading-status").attr("class", "text-danger").text("發生錯誤，請刷新頁面")
        }
    </script>

</body>

</html>